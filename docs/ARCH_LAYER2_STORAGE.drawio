<mxfile host="app.diagrams.net" modified="2025-12-24T00:00:00.000Z" agent="Codex" version="24.7.8" editor="draw.io">
  <diagram id="layer2-storage" name="Layer 2 - Storage">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <mxCell id="t" value="Layer 2 · 存储层（Storage）" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontStyle=1;fontSize=16;fillColor=#ffffff;strokeColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="40" y="20" width="1320" height="40" as="geometry" />
        </mxCell>

        <mxCell id="lane" value="单一事实源：SQL 主库（先做） + 可插拔向量索引（后接） + 原文/产物存储" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8fafc;strokeColor=#94a3b8;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="1320" height="740" as="geometry" />
        </mxCell>

        <mxCell id="sql" value="SQL 主库（SQLite/Postgres）&#10;SQLAlchemy + Alembic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fdf4;strokeColor=#22c55e;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="140" width="520" height="110" as="geometry" />
        </mxCell>

        <mxCell id="mem" value="Memory Store（已实现）&#10;- memory_sources&#10;- memory_items (scope/status/pii/use_count)&#10;- memory_audit_log" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fdf4;strokeColor=#22c55e;" vertex="1" parent="1">
          <mxGeometry x="90" y="280" width="520" height="120" as="geometry" />
        </mxCell>

        <mxCell id="research" value="Research Store（已实现）&#10;- research_tracks / tasks / milestones&#10;- paper_feedback&#10;- research_track_embeddings" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fdf4;strokeColor=#22c55e;" vertex="1" parent="1">
          <mxGeometry x="90" y="420" width="520" height="120" as="geometry" />
        </mxCell>

        <mxCell id="replay" value="Replay / Evals（已实现）&#10;- research_context_runs&#10;- paper_impressions&#10;用于回放与评测汇总" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fdf4;strokeColor=#22c55e;" vertex="1" parent="1">
          <mxGeometry x="90" y="560" width="520" height="120" as="geometry" />
        </mxCell>

        <mxCell id="paperlib" value="Paper Library（建议下一步）&#10;- paper_items (canonical id: doi/arxiv/s2/github)&#10;- paper_sources (来源/抓取)&#10;- paper_chunks (text spans)&#10;- paper_embeddings (optional)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fdf4;strokeColor=#22c55e;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="660" y="280" width="650" height="170" as="geometry" />
        </mxCell>

        <mxCell id="doc" value="Document/Artifact Store（可选）&#10;- raw PDFs / HTML snapshots&#10;- exports (EvidencePack)&#10;S3 / FS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fdf4;strokeColor=#22c55e;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="660" y="470" width="320" height="130" as="geometry" />
        </mxCell>

        <mxCell id="vec" value="Vector Index（可插拔）&#10;Qdrant/Milvus/Weaviate&#10;Adapter via VectorStorePort" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0fdf4;strokeColor=#22c55e;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="990" y="470" width="320" height="130" as="geometry" />
        </mxCell>

        <mxCell id="schema" value="标准化 Metadata Schema（示例）&#10;{ paper_id, title, authors, venue, published_date, topics, citation_count, trending_score }" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#eef2ff;strokeColor=#6366f1;" vertex="1" parent="1">
          <mxGeometry x="660" y="140" width="650" height="110" as="geometry" />
        </mxCell>

        <!-- Edges -->
        <mxCell id="e1" value="owns" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#16a34a;" edge="1" parent="1" source="sql" target="mem">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e2" value="owns" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#16a34a;" edge="1" parent="1" source="sql" target="research">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e3" value="owns" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#16a34a;" edge="1" parent="1" source="sql" target="replay">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e4" value="future" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#16a34a;dashed=1;" edge="1" parent="1" source="schema" target="paperlib">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e5" value="store chunks/raw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#16a34a;dashed=1;" edge="1" parent="1" source="paperlib" target="doc">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e6" value="index embeddings" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#16a34a;dashed=1;" edge="1" parent="1" source="paperlib" target="vec">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>

